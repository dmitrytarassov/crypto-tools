{"version":3,"sources":["../../src/polkadot/staking/getLedgerData.ts","../../src/polkadot/balances/getAccountData.ts","../../src/polkadot/staking/getController.ts","../../src/polkadot/account/getAccountNonce.ts","../../src/polkadot/staking/getErasRewardPoints.ts","../../src/polkadot/common/polkadotExplorerUrl.ts","../../src/polkadot/staking/getActiveEra.ts","../../src/polkadot/index.ts"],"sourcesContent":["import { ApiPromise } from \"@polkadot/api\";\n\ntype Staking_Ledger_Json = {\n  stash: string;\n  total: string;\n  active: string;\n  unlocking: string[];\n  claimedRewards: number[];\n};\n\nexport async function getLedgerData(\n  apiPromise: ApiPromise,\n  address: string\n): Promise<Staking_Ledger_Json | null> {\n  const data = await apiPromise.query.staking.ledger(address);\n\n  return data.toJSON() as unknown as Staking_Ledger_Json | null;\n}\n","import { ApiPromise } from \"@polkadot/api\";\n\ntype Staking_Account_Json = {\n  nonce: number;\n  consumers: number;\n  providers: number;\n  sufficients: number;\n  data: {\n    free: string;\n    reserved: number;\n    frozen: string;\n    flags: string;\n  };\n};\n\nexport async function getAccountData(\n  apiPromise: ApiPromise,\n  address: string\n): Promise<Staking_Account_Json | null> {\n  const data = await apiPromise.query.staking.account(address);\n\n  return data.toJSON() as unknown as Staking_Account_Json | null;\n}\n","import { ApiPromise } from \"@polkadot/api\";\nimport { isAddress } from \"@polkadot/util-crypto\";\n\nexport const getController = async (\n  api: ApiPromise,\n  address: string\n): Promise<string | null> => {\n  if (!isAddress(address)) {\n    throw new Error(`${address} is not an address`);\n  }\n\n  const response = await api.query.staking.bonded(address);\n\n  if (response && response.toString()) {\n    return response.toString();\n  }\n\n  return null;\n};\n","import { ApiPromise } from \"@polkadot/api\";\n\ninterface Bump {\n  (): number;\n}\n\nexport async function getAccountNonce(\n  apiPromise: ApiPromise,\n  account: string\n): Promise<number> {\n  const nonce = await apiPromise.rpc.system.accountNextIndex(account);\n\n  return parseInt(nonce.toString(), 10);\n}\n\nexport async function getAccountNonceAndBump(\n  apiPromise: ApiPromise,\n  account: string\n): Promise<[number, Bump]> {\n  const nonce = await getAccountNonce(apiPromise, account);\n\n  let i = 0;\n  return [\n    nonce,\n    () => {\n      i++;\n      return nonce + i;\n    },\n  ];\n}\n","import { ApiPromise } from \"@polkadot/api\";\n\ntype ErasRewardPointsResult = {\n  total: number;\n  individual: {\n    [validator: string]: number;\n  };\n};\nexport async function getErasRewardPoints(apiPromise: ApiPromise, era: number) {\n  if (era < 0) {\n    throw new Error(`Provided Era: ${era} is less than zero`);\n  }\n\n  const points = await apiPromise.query.staking.erasRewardPoints(era);\n  return points.toJSON() as unknown as ErasRewardPointsResult;\n}\n","import { Hash } from \"@polkadot/types/interfaces\";\n\ntype LinkType =\n  | \"account\"\n  | \"address\"\n  | \"a\"\n  | \"extrinsic\"\n  | \"transaction\"\n  | \"t\"\n  | \"validator\"\n  | \"v\";\n\nconst linkType: {\n  [key in LinkType]: string;\n} = {\n  account: \"account\",\n  address: \"account\",\n  a: \"account\",\n  extrinsic: \"extrinsic\",\n  transaction: \"extrinsic\",\n  t: \"extrinsic\",\n  validator: \"validator\",\n  v: \"validator\",\n};\n\nexport function polkadotExplorerUrl(\n  networkName: string,\n  domain = \"subscan.io\"\n) {\n  return function (type: LinkType, addressOrHash: string | Hash): string {\n    const value =\n      typeof addressOrHash === \"string\"\n        ? addressOrHash\n        : addressOrHash.toHuman();\n\n    return `https://${networkName.toLowerCase()}.${domain}/${\n      linkType[type]\n    }/${value}`;\n  };\n}\n","import { ApiPromise } from \"@polkadot/api\";\n\nexport const getActiveEra = async (api: ApiPromise): Promise<number> => {\n  const era = (await api.query.staking.activeEra()).toString();\n  return parseInt(era, 10);\n};\n","export { getLedgerData } from \"./staking/getLedgerData\";\nexport { getAccountData } from \"./balances/getAccountData\";\nexport { getController } from \"./staking/getController\";\nexport {\n  getAccountNonce,\n  getAccountNonceAndBump,\n} from \"./account/getAccountNonce\";\nexport { getErasRewardPoints } from \"./staking/getErasRewardPoints\";\nexport { polkadotExplorerUrl } from \"./common/polkadotExplorerUrl\";\n\nimport * as _getActiveEra from \"./staking/getActiveEra\";\nexport const getActiveEra = _getActiveEra.getActiveEra;\nexport const getCurrentEra = _getActiveEra.getActiveEra;\n"],"mappings":";AAUA,eAAsB,cACpB,YACA,SACqC;AACrC,QAAM,OAAO,MAAM,WAAW,MAAM,QAAQ,OAAO,OAAO;AAE1D,SAAO,KAAK,OAAO;AACrB;;;ACFA,eAAsB,eACpB,YACA,SACsC;AACtC,QAAM,OAAO,MAAM,WAAW,MAAM,QAAQ,QAAQ,OAAO;AAE3D,SAAO,KAAK,OAAO;AACrB;;;ACrBA,SAAS,iBAAiB;AAEnB,IAAM,gBAAgB,OAC3B,KACA,YAC2B;AAC3B,MAAI,CAAC,UAAU,OAAO,GAAG;AACvB,UAAM,IAAI,MAAM,GAAG,OAAO,oBAAoB;AAAA,EAChD;AAEA,QAAM,WAAW,MAAM,IAAI,MAAM,QAAQ,OAAO,OAAO;AAEvD,MAAI,YAAY,SAAS,SAAS,GAAG;AACnC,WAAO,SAAS,SAAS;AAAA,EAC3B;AAEA,SAAO;AACT;;;ACZA,eAAsB,gBACpB,YACA,SACiB;AACjB,QAAM,QAAQ,MAAM,WAAW,IAAI,OAAO,iBAAiB,OAAO;AAElE,SAAO,SAAS,MAAM,SAAS,GAAG,EAAE;AACtC;AAEA,eAAsB,uBACpB,YACA,SACyB;AACzB,QAAM,QAAQ,MAAM,gBAAgB,YAAY,OAAO;AAEvD,MAAI,IAAI;AACR,SAAO;AAAA,IACL;AAAA,IACA,MAAM;AACJ;AACA,aAAO,QAAQ;AAAA,IACjB;AAAA,EACF;AACF;;;ACrBA,eAAsB,oBAAoB,YAAwB,KAAa;AAC7E,MAAI,MAAM,GAAG;AACX,UAAM,IAAI,MAAM,iBAAiB,GAAG,oBAAoB;AAAA,EAC1D;AAEA,QAAM,SAAS,MAAM,WAAW,MAAM,QAAQ,iBAAiB,GAAG;AAClE,SAAO,OAAO,OAAO;AACvB;;;ACHA,IAAM,WAEF;AAAA,EACF,SAAS;AAAA,EACT,SAAS;AAAA,EACT,GAAG;AAAA,EACH,WAAW;AAAA,EACX,aAAa;AAAA,EACb,GAAG;AAAA,EACH,WAAW;AAAA,EACX,GAAG;AACL;AAEO,SAAS,oBACd,aACA,SAAS,cACT;AACA,SAAO,SAAU,MAAgB,eAAsC;AACrE,UAAM,QACJ,OAAO,kBAAkB,WACrB,gBACA,cAAc,QAAQ;AAE5B,WAAO,WAAW,YAAY,YAAY,CAAC,IAAI,MAAM,IACnD,SAAS,IAAI,CACf,IAAI,KAAK;AAAA,EACX;AACF;;;ACrCO,IAAM,eAAe,OAAO,QAAqC;AACtE,QAAM,OAAO,MAAM,IAAI,MAAM,QAAQ,UAAU,GAAG,SAAS;AAC3D,SAAO,SAAS,KAAK,EAAE;AACzB;;;ACMO,IAAMA,gBAA6B;AACnC,IAAM,gBAA8B;","names":["getActiveEra"]}